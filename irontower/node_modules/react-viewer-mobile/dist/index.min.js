!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],e):"object"==typeof exports?exports["react-viewer-mobile"]=e(require("react"),require("react-dom")):t["react-viewer-mobile"]=e(t.React,t.ReactDOM)}(this,function(t,e){return function(t){function e(o){if(i[o])return i[o].exports;var s=i[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),n=o(s);e["default"]=n["default"],t.exports=e["default"]},function(e,i){e.exports=t},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function n(t,e){for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var s=i[o],n=Object.getOwnPropertyDescriptor(e,s);n&&n.configurable&&void 0===t[s]&&Object.defineProperty(t,s,n)}return t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):n(t,e))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var h=i(1),p=s(h),u=i(6),l=s(u),f=i(4),d=o(f),v=function(t){function e(){r(this,e);var i=a(this,t.call(this));return i.container=null,i.component=null,i}return c(e,t),e.prototype.renderViewer=function(){if(this.props.visible||this.component){this.container||(this.container=document.createElement("div"),document.body.appendChild(this.container));var t=this;l.unstable_renderSubtreeIntoContainer(this,p.createElement(d["default"],this.props),this.container,function(){t.component=this})}},e.prototype.removeViewer=function(){if(this.container){var t=this.container;l.unmountComponentAtNode(t),t.parentNode.removeChild(t),this.container=null,this.component=null}},e.prototype.componentWillUnmount=function(){this.removeViewer()},e.prototype.componentDidMount=function(){this.renderViewer()},e.prototype.componentDidUpdate=function(){this.renderViewer()},e.prototype.render=function(){return null},e}(p.Component);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function s(t,e){for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var s=i[o],n=Object.getOwnPropertyDescriptor(e,s);n&&n.configurable&&void 0===t[s]&&Object.defineProperty(t,s,n)}return t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):s(t,e))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var c=i(1),h=o(c),p=function(t){function e(){return n(this,e),r(this,t.call(this))}return a(e,t),e.prototype.render=function(){var t={width:this.props.width+"px",height:this.props.height+"px",marginTop:this.props.top+"px",marginLeft:this.props.left?this.props.left+"px":"auto"},e="",i=this.props.prefixCls+"-canvas";this.props.touch||(e+=" "+this.props.prefixCls+"-image-transition",i+=" "+this.props.prefixCls+"-canvas-transition");var o={zIndex:this.props.zIndex,transform:"translateX("+this.props.translateX+"px)"},s=null;return""!==this.props.imgSrc&&(s=h.createElement("img",{className:e,src:this.props.imgSrc,style:t})),h.createElement("div",{className:i,style:o},s)},e}(h.Component);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function n(t,e){for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var s=i[o],n=Object.getOwnPropertyDescriptor(e,s);n&&n.configurable&&void 0===t[s]&&Object.defineProperty(t,s,n)}return t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):n(t,e))}function h(){}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var p=i(1),u=s(p);i(5);var l=i(3),f=o(l),d=.9,v=window.innerWidth*d,m=window.innerWidth*d,g=function(t){function e(i){r(this,e);var o=a(this,t.call(this,i));return o.handleBodyTouchmove=function(t){t.preventDefault()},o.startVisible=function(t){document.body.addEventListener("touchmove",o.handleBodyTouchmove,{passive:!1}),o.loadImg(t,!0)},o.close=function(){document.body.removeEventListener("touchmove",o.handleBodyTouchmove),o.props.onClose()},o.prefixCls="react-viewer-mobile",o.state={activeIndex:o.props.activeIndex,scale:1,touch:!1,swiperDistance:0,touchStartTime:0,touchDistance:0,startX:0,startY:0,moveX:0,moveY:0,pinchScale:1,zoomCenterX:0,zoomCenterY:0},o.containerWidth=window.innerWidth,o.containerHeight=window.innerHeight,o}return c(e,t),e.prototype.handleTouchStart=function(t){t.preventDefault(),t.stopPropagation();var e=0,i=0,o=0,s=!1,n=Date.now();t.touches.length>1&&0===this.state.swiperDistance&&(e=this.getDistance({x:t.touches[0].pageX,y:t.touches[0].pageY},{x:t.touches[1].pageX,y:t.touches[1].pageY}),i=t.touches[0].pageX+(t.touches[1].pageX-t.touches[0].pageX)/2,o=t.touches[0].pageY+(t.touches[1].pageY-t.touches[0].pageY)/2,s=!0);var r=t.touches[0].pageX,a=t.touches[0].pageY;this.setState({touch:!0,startX:r,startY:a,moveX:r,moveY:a,startScale:this.state.scale,touchDistance:e,zoomCenterX:i,zoomCenterY:o,multiTouch:s,touchStartTime:n})},e.prototype.handleTouchMove=function(t){if(t.preventDefault(),t.stopPropagation(),t.touches.length>1){var e=this.getDistance({x:t.touches[0].pageX,y:t.touches[0].pageY},{x:t.touches[1].pageX,y:t.touches[1].pageY}),i=e/this.state.touchDistance,o=this.state.scale+this.state.startScale*(i-this.state.pinchScale);o<=3&&0===this.state.swiperDistance&&this.handleZoom(this.state.zoomCenterX,this.state.zoomCenterY,o,i)}else if(this.state.scale>1){var s=this.state.left+t.touches[0].pageX-this.state.moveX,n=this.state.top+t.touches[0].pageY-this.state.moveY;this.setState({left:s,top:n,moveX:t.touches[0].pageX,moveY:t.touches[0].pageY})}else{var r=this.state.swiperDistance+t.touches[0].pageX-this.state.moveX;this.setState({swiperDistance:r,moveX:t.touches[0].pageX,moveY:t.touches[0].pageY})}},e.prototype.handleTouchEnd=function(t){var e=this;t.preventDefault(),t.stopPropagation();var i=Date.now()-this.state.touchStartTime;if(0===t.touches.length){if(this.state.multiTouch)this.state.scale<1&&setTimeout(function(){e.resetImage()},0);else if(0!==this.state.swiperDistance){var o=.4*this.containerWidth,s=!1,n=i<300;if((this.state.swiperDistance<=-o||this.state.swiperDistance>=o||n)&&(s=!0),s){var r=void 0;(this.state.swiperDistance<=-o||n&&this.state.swiperDistance<0)&&(r=this.state.activeIndex+1,r===this.props.images.length&&(r=this.state.activeIndex)),(this.state.swiperDistance>=o||n&&this.state.swiperDistance>0)&&(r=this.state.activeIndex-1,r<0&&(r=this.state.activeIndex)),this.loadImg(r)}else this.setState({swiperDistance:0,touch:!1})}else Math.abs(this.state.moveX-this.state.startX)>10||Math.abs(this.state.moveY-this.state.startY)>10||i<500&&this.close();this.setState({startX:0,startY:0,moveX:0,moveY:0,pinchScale:1,touchDistance:0,multiTouch:!1,touch:!1,touchStartTime:0})}else this.setState({moveX:t.touches[0].pageX,moveY:t.touches[0].pageY})},e.prototype.resetImage=function(){var t=this.getImgDefaultSize(this.state.imageWidth,this.state.imageHeight);this.setState({width:t.width,height:t.height,left:t.left,top:t.top,scale:1,touch:!1})},e.prototype.getImageCenterXY=function(){return{x:this.state.left+this.state.width/2,y:this.state.top+this.state.height/2}},e.prototype.getImgDefaultSize=function(t,e){var i=0,o=0,s=this.containerWidth*d,n=this.containerHeight*d;i=Math.min(s,t),o=i/t*e,o>n&&(o=n,i=o/e*t);var r=(this.containerWidth-i)/2,a=(this.containerHeight-o)/2;return{width:i,height:o,left:r,top:a}},e.prototype.getDistance=function(t,e){var i=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return Math.sqrt(i*i+o*o)},e.prototype.loadImg=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o="",s=this.props.images||[];s.length>0&&(o=s[t].src);var n=new Image;n.src=o,i?this.setState({activeIndex:t,width:0,height:0,left:this.containerWidth/2,top:this.containerHeight/2,scale:1,swiperDistance:0,touch:!1}):this.setState({activeIndex:t,swiperDistance:0,touch:!1}),n.onload=function(){var o=n.width,s=n.height;if(i)setTimeout(function(){e.setState({imageWidth:o,imageHeight:s});var t=e.getImageCenterXY();e.handleZoom(t.x,t.y,1,1)},0);else{var r=e.getImgDefaultSize(o,s);e.setState({activeIndex:t,width:r.width,height:r.height,left:r.left,top:r.top,imageWidth:o,imageHeight:s,scale:1})}},n.onerror=function(){e.setState({activeIndex:t,imageWidth:0,imageHeight:0})}},e.prototype.handleZoom=function(t,e,i,o){var s=i-this.state.scale,n=this.getImageCenterXY(),r=t-n.x,a=e-n.y,c=this.state.width*s,h=this.state.height*s;if(0===c){var p=this.getImgDefaultSize(this.state.imageWidth,this.state.imageHeight);c=p.width,h=p.height}this.setState({width:this.state.width+c,height:this.state.height+h,top:this.state.top-h/2-a*s,left:this.state.left-c/2-r*s,scale:i,pinchScale:o})},e.prototype.componentDidMount=function(){this.startVisible(this.props.activeIndex)},e.prototype.componentWillReceiveProps=function(t){var e=this;return!this.props.visible&&t.visible?(this.startVisible(t.activeIndex),void setTimeout(function(){e.setState({swiperDistance:0})},10)):this.state.activeIndex!==t.activeIndex?void this.loadImg(t.activeIndex):void 0},e.prototype.render=function(){var t=this,e=""+this.prefixCls,i={opacity:this.props.visible?1:0,width:window.innerWidth,height:window.innerHeight,position:"absolute",top:0};this.props.visible||(i.display="none"),this.props.visible&&(i.display="block");var o=this.props.zIndex,s={src:"",alt:""},n=this.props.images||[];this.props.visible&&n.length>0&&this.state.activeIndex>=0&&(s=n[this.state.activeIndex]);for(var r=[],a=this.containerWidth,c=0;c<this.state.activeIndex;c++){var h=-a*(this.state.activeIndex-c)+this.state.swiperDistance;r.push(h)}for(var p=this.state.activeIndex;p<this.props.images.length;p++){var l=a*(p-this.state.activeIndex)+this.state.swiperDistance;r.push(l)}return u.createElement("div",{className:e,style:i,onTouchStart:this.handleTouchStart.bind(this),onTouchMove:this.handleTouchMove.bind(this),onTouchEnd:this.handleTouchEnd.bind(this)},u.createElement("div",{className:this.prefixCls+"-mask",style:{zIndex:o}}),this.props.images.map(function(e,i){return i===t.state.activeIndex?u.createElement(f["default"],{key:i,prefixCls:t.prefixCls,imgSrc:e.src,visible:t.props.visible,width:t.state.width,height:t.state.height,top:t.state.top,left:t.state.left,zIndex:o+5,touch:t.state.touch,translateX:r[i]}):Math.abs(t.state.activeIndex-i)>1?null:u.createElement(f["default"],{key:i,prefixCls:t.prefixCls,imgSrc:e.src,visible:t.props.visible,width:v,height:m,top:(t.containerHeight-m)/2,left:(t.containerWidth-v)/2,zIndex:o+5,touch:t.state.touch,translateX:r[i]})}),u.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:o+10}},this.text1),u.createElement("div",{style:{position:"absolute",top:20,left:0,zIndex:o+10}},this.text2))},e}(u.Component);e["default"]=g,g.defaultProps={visible:!1,onClose:h,images:[],activeIndex:0,zIndex:1e3},t.exports=e["default"]},function(t,e){},function(t,i){t.exports=e}])});